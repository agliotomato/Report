## 예시1

<p align="center">
  <img src="images/00090.png" width="23%" />
  <img src="images/structure_facingfront.png" width="23%" />
  <img src="images/b_2.png" width="23%" />
  <img src="images/Result_image.png" width="23%" />
 </p>

### mask 관련 중간 내용
<p align="center">
<img src="images/mask_src_face_256.png"         width="200" />
<img src="images/mask_target_face_256.png" width="200" />
  <img src="images/mask_aligned_hair_256.png" width="200" />
  <img src="images/mask_aref_hair_256.png" width="200" />
  <img src="images/mask_current_hair_256.png" width="200" />    
</p>



### blend_initial_mixed/blend_initial_hair
<p align="center">
  <img src="images/blend_initial_mixed.png" width="300" />
  <img src="images/blend_initial_hair.png" width="300"/>
 </p>

 - blend_initial_mixed.png :
소스 얼굴은 유지하면서, 헤어 영역만 구조 기여자(Shape)의 구조를 주입해 본, 초기 합성 이미지
- I_G, _ = ii2s.generator([latent_mixed], input_is_latent=True, return_latents=False, start_layer=4, end_layer=8, layer_in=F_mixed)
- blend_initial_hair.png : 헤어 영역을 강조해본 "헤어 중심 미리보기", 이후 최적화에서 loss_hair_percept 과 style_loss의 참조로 사용
- I_G_color, _ = ii2s.generator([latent_mixed], input_is_latent=True, return_latents=False, start_layer=4, end_layer=8, layer_in=F_hair)
- StyleGAN은 latent만 받아서 내부적으로 feature map을 만들어가며 이미지를 생성하지만, layer_in 을 사용하게 된다면 
- 기존 StyleGAN이 만든 중간 feature 말고, F_hair를 레이어에 직접 넣어라 라는 뜻.
- 두 이미지는 최적화(블렌딩) 시작 전, 구조 주입과 스타일 기준을 점검하기 위함임

### blend 단계(1/25/50/75/100)
<p align="center">
  <img src="images/blend_step_001.png" width="200" />
  <img src="images/blend_step_025.png" width="200" />
  <img src="images/blend_step_050.png" width="200" />
  <img src="images/blend_step_075.png" width="200" />
  <img src="images/blend_step_100.png" width="200" />
</p>


- blend_step_.XX.png 는 두 이미지를 섞어 저장하는 게 아니라 최적화 중 현재 잠복벡터(interpolation_latent)로 생성한 결과 이미지를 스냅샷으로 저장한 것임. 이 I_G는 생성시 호출 시 layer_in=F_mixed로 만든 출력이다.


### S 코드 최적화 과정(1/25/50/75/100)
<p align="center">
  <img src="images/blend_step_001_hair.png" width="200" />
  <img src="images/blend_step_025_hair.png" width="200" />
  <img src="images/blend_step_050_hair.png" width="200" />
  <img src="images/blend_step_075_hair.png" width="200" />
  <img src="images/blend_step_100_hair.png" width="200" />
</p>

- hair_blend는 같은 interpolation_latent 지만, layer_in=F_hair로 만든 결과
- F_hair는 머리 외관 특성이 강조된 피처. 
- 변하는 것 : S
- 고정 : F_hair, F_mixed
- 동일 S로 두 이미지를 만듦. I_G(layer_in-F_mixed)  I_G_color(layer_in=F_hair)
- Hair perceptual loss : I_G_color vs im_3의 머리 영역(mask_hair) - 영역에 한정하여 perceptual loss 차이를 최소화
- Style loss : I_G의 머리 영역(mask_2_hair) vs im_3의 머리 영역(mask_hair) - 질감/색감 스타일 유사도 강화
- hair_blend는 I_G_color가 참조 머리와 마스크된 영역에서 비슷해지도록 되는 과정



## 예시2
<p align="center">
  <img src="images/00090.png" width="23%" />
  <img src="images/structure_facingfront.png" width="23%" />
  <img src="images/a.jpg" width="23%" />
  <img src="images2/Result_image.png" width="23%" />
 </p>

### mask 관련 중간 내용
<p align="center">
<img src="images2/mask_src_face_256.png" width="200" />
<img src="images2/mask_target_face_256.png" width="200" />
  <img src="images2/mask_aligned_hair_256.png" width="200" />
  <img src="images2/mask_aref_hair_256.png" width="200" />
  <img src="images2/mask_current_hair_256.png" width="200" />    
</p>

### blend_initial_mixed/blend_initial_hair
<p align="center">
  <img src="images2/blend_initial_mixed.png" width="300" />
  <img src="images2/blend_initial_hair.png" width="300"/>
 </p>

### blend 단계(1/25/50/75/100)
<p align="center">
  <img src="images2/blend_step_001.png" width="200" />
  <img src="images2/blend_step_025.png" width="200" />
  <img src="images2/blend_step_050.png" width="200" />
  <img src="images2/blend_step_075.png" width="200" />
  <img src="images2/blend_step_100.png" width="200" />
</p>


### S 코드 최적화 과정(1/25/50/75/100)
<p align="center">
  <img src="images2/blend_step_001_hair.png" width="200" />
  <img src="images2/blend_step_025_hair.png" width="200" />
  <img src="images2/blend_step_050_hair.png" width="200" />
  <img src="images2/blend_step_075_hair.png" width="200" />
  <img src="images2/blend_step_100_hair.png" width="200" />
</p>

- S blend는 I_G_color가 참조 머리와 마스크된 영역에서 비슷해지도록 함
- 헤어 외관 손실의 기준으로 S를 올바른 방향으로 유도한다.
- 최종 이미지는 I_G_blend 이며, I_G_color는 손실을 통해 간접적으로 최종 머리 색/질감/품질을 결정한다.

## 예시3

### 기존 예시와의 차이점 정리
- allign 과정에서 바뀐 머리 모양에 맞추어 appearance image 헤어 맞추기 <- 나노 바나나 or qwen 이용

<p align="center">
  <img src="images/00090.png" width="23%" />
  <img src="images/structure_facingfront.png" width="23%" />
  <img src="images3/a__2.png" width="23%" />
  <img src="images3/Result_image.png" width="23%" />
 </p>

### mask 관련 중간 내용
<p align="center">
<img src="images3/mask_src_face_256.png" width="200" />
<img src="images3/mask_target_face_256.png" width="200" />
  <img src="images3/mask_aligned_hair_256.png" width="200" />
  <img src="images3/mask_aref_hair_256.png" width="200" />
  <img src="images3/mask_current_hair_256.png" width="200" />    
</p>

### blend_initial_mixed/blend_initial_hair
<p align="center">
  <img src="images3/blend_initial_mixed.png" width="300" />
  <img src="images3/blend_initial_hair.png" width="300"/>
 </p>

 ### blend 단계(1/25/50/75/100)
<p align="center">
  <img src="images3/blend_step_001.png" width="200" />
  <img src="images3/blend_step_025.png" width="200" />
  <img src="images3/blend_step_050.png" width="200" />
  <img src="images3/blend_step_075.png" width="200" />
  <img src="images3/blend_step_100.png" width="200" />
</p>

### S 코드 최적화 과정(1/25/50/75/100)
<p align="center">
  <img src="images3/blend_step_001_hair.png" width="200" />
  <img src="images3/blend_step_025_hair.png" width="200" />
  <img src="images3/blend_step_050_hair.png" width="200" />
  <img src="images3/blend_step_075_hair.png" width="200" />
  <img src="images3/blend_step_100_hair.png" width="200" />
</p>





